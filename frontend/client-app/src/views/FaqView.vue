<template>
  <div class="page faq-page">
    <header class="page-header">
      <h1>{{ $t('faq.title') || 'FAQ — Частые вопросы' }}</h1>
      <p class="lead">Ниже собрали ответы на популярные вопросы по работе с системой.</p>
    </header>

  <section class="faq-list" aria-label="FAQ">
      <details v-for="(item, idx) in faqs" :key="idx" :id="item.anchor">
        <summary>
          <span class="q">{{ item.q }}</span>
        </summary>
        <div class="a" v-html="item.a"></div>
      </details>
    </section>

    <footer class="faq-footer">
      <p>
        Не нашли ответ? Напишите нам на почту
        <a href="mailto:crmlegalflow@gmail.com">crmlegalflow@gmail.com</a>
      </p>
    </footer>
  </div>
</template>

<script setup>
const faqs = [
  {
    anchor: 'invite-users',
    q: 'Как пригласить сотрудника в компанию?',
    a: `<div>
      <p><strong>Приглашение создаётся во вкладке «Приглашения»</strong> в разделе «Настройки».</p>
      <ul>
        <li>Выберите роль, которая будет присвоена приглашённому (например: Менеджер, Юрист/Консультант, Ассистент).</li>
        <li>Нажмите «Создать приглашение» — система создаст ссылку-приглашение.</li>
        <li>Скопируйте и отправьте ссылку коллеге — после регистрации он автоматически появится в списке «Пользователи».</li>
      </ul>
      <p>Приглашать сотрудников может только Руководитель компании.</p>
    </div>`
  },
  {
    anchor: 'roles-rights',
    q: 'Какие роли есть в системе?',
    a: `<ul class="faq-roles">
      <li><strong>Руководитель</strong> — полный доступ к клиентам, задачам и делам компании, настройкам и пользователям.</li>
      <li><strong>Менеджер</strong> — работа с клиентами и делами компании, задачи и календарь, доступ к разделу «Финансы».</li>
        <li><strong>Юрист/Консультант</strong> — работа с клиентами и делами, задачи и календарь, доступ к разделу «Финансы».</li>
        <li><strong>Ассистент</strong> — нет доступа к разделу «Финансы»; помогает по задачам и календарю.</li>
    </ul>
    <div class="faq-matrix">
      <p><strong>Доступ и видимость:</strong></p>
      <ul>
        <li>Финансы: доступны ролям <strong>Руководитель</strong>, <strong>Менеджер</strong>, <strong>Юрист/Консультант</strong>; у <strong>Ассистент</strong> доступа нет.</li>
        <li>Клиенты и дела: <strong>Руководитель</strong> видит всех клиентов компании; <strong>Менеджер</strong> — только своих (назначенных ему) клиентов и их дела; <strong>Юрист/Консультант</strong> и <strong>Ассистент</strong> — видят всех клиентов.</li>
        <li>Пользователи и настройки компании: только <strong>Руководитель</strong>.</li>
        <li>Задачи и календарь: доступны всем ролям.</li>
        <li>Уведомления: доступны всем ролям.</li>
      </ul>
    </div>`
  },
  {
    anchor: 'create-client',
    q: 'Как создать клиента?',
    a: `<div>
      <p><strong>Где:</strong> раздел «Клиенты».</p>
      <ol>
        <li>Нажмите кнопку «Добавить клиента».</li>
        <li>Заполните поля: Имя, Фамилия, Email, Телефон.</li>
        <li>Если у вас роль Руководитель/Администратор — вы можете назначить ответственного менеджера.</li>
        <li>Сохраните. Новый клиент появится в списке. Менеджер увидит только назначенных ему клиентов.</li>
      </ol>
    </div>`
  },
  {
    anchor: 'create-case',
    q: 'Как создать дело и добавить документы?',
    a: `<div>
      <p><strong>Где:</strong> в карточке клиента (открывается кликом по строке клиента в списке).</p>
      <ol>
        <li>Откройте Клиенты → клик по нужному клиенту.</li>
        <li>Внизу карточки нажмите «Добавить новое дело».</li>
        <li>Укажите Вид дела, даты подачи/решения и Статус дела.</li>
        <li>Изменения в карточке сохраняются автоматически при выборе значений.</li>
        <li>При необходимости добавьте напоминания клиенту в секции «Напоминания клиенту» — письмо уйдёт на email клиента в указанное время.</li>
      </ol>
      <p style="margin-top:8px"><strong>Документы по делу (чек‑лист):</strong></p>
      <ul>
        <li>Раскройте дело и перейдите в «Чек-лист поданных документов».</li>
        <li>Отмечайте галочкой документы, которые уже поданы.</li>
        <li>Чтобы приложить файлы, нажмите «Загрузить» напротив документа и выберите файлы — они появятся как метки и доступны для просмотра.</li>
        <li>Если нужен другой тип документа, нажмите «Добавить документ», впишите название и при необходимости загрузите файлы.</li>
        <li>Ненужную строку можно удалить крестиком.</li>
      </ul>
    </div>`
  },
  {
    anchor: 'tasks-usage',
    q: 'Как работают задачи (создание, права, статусы)?',
    a: `<ul>
      <li><strong>Где создать:</strong> разделы «Календарь» и «Задачи» — кнопка «Создать задачу».</li>
      <li><strong>Что можно менять:</strong> заголовок, даты, клиента, статус, ответственного.</li>
      <li><strong>Назначение:</strong> Руководитель может назначать задачу менеджеру и другим пользователям компании.</li>
      <li><strong>Статусы:</strong> Запланировано, Выполнено, Отменено. На главной есть кнопка «Готово» для быстрого закрытия задачи.</li>
      <li><strong>Права по задачам:</strong> задачи и календарь доступны всем ролям. Руководитель — видит все задачи компании; Менеджер — видит только задачи, где он назначен ответственным; Юрист/Консультант и Ассистент — видят все задачи.</li>
      <li><strong>Уведомления:</strong> входящие оповещения видны в разделе «Уведомления»; можно отмечать как прочитанные.</li>
    </ul>`
  },
  {
    anchor: 'notifications-how',
    q: 'Как работают уведомления?',
    a: `<ul>
      <li><strong>Что приходит:</strong> уведомления о назначенных задачах и о факте отправки напоминания клиенту.</li>
      <li><strong>Напоминания клиенту:</strong> вы создаёте напоминание в карточке клиента; в назначенный день и (если указано) время система автоматически отправит клиенту письмо на его email. После отправки в системе появляется внутреннее уведомление для ответственного сотрудника с пометкой «отправлено» (или «ошибка отправки», если письмо не ушло).</li>
      <li><strong>Куда отправляется:</strong> письмо — на email из карточки клиента; внутреннее уведомление — в виджете и разделе «Уведомления».</li>
      <li><strong>Где смотреть:</strong> виджет «Уведомления» на главной и раздел «Уведомления» в кабинете. В сайдбаре отображается счётчик непрочитанных.</li>
      <li><strong>Как читать:</strong> клик по уведомлению открывает карточку клиента, если он указан в задаче либо напоминании. Можно отметить одно или все уведомления как прочитанные.</li>
      <li><strong>Метки:</strong> в уведомлении отображаются клиент, пользователь, тип напоминания и источник (Напоминание/Система).</li>
    </ul>`
  }
]
</script>

<style scoped>
.page { padding: 24px; }
.page-header { margin-bottom: 18px; }
.page-header h1 { font-size: 24px; margin: 0 0 6px; }
.page-header .lead { color: #475569; margin: 0; }

.faq-list { display: grid; gap: 10px; }
.faq-list details { background: var(--card-bg, #fff); border: 1px solid var(--card-border, #e5e7eb); border-radius: 10px; padding: 10px 14px; }
.faq-list summary { cursor: pointer; font-weight: 600; color: #0f172a; outline: none; }
.faq-list summary::-webkit-details-marker { display:none; }
.faq-list summary { display:flex; align-items:center; gap:8px; }
.faq-list summary::before { content:'❓'; opacity:.8; }
.faq-list .a { color:#334155; padding:10px 2px 2px; line-height: 1.5; }
.faq-list a { color: var(--primary-color, #4A90E2); text-decoration: none; }
.faq-list a:hover { text-decoration: underline; }

.faq-footer { margin-top: 16px; color: #475569; }
</style>
